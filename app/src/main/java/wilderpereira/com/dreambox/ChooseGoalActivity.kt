package wilderpereira.com.dreambox

import android.os.AsyncTask
import android.os.Bundle
import android.support.v7.app.AppCompatActivity
import android.util.Log
import android.view.View
import com.google.gson.Gson
import okhttp3.MediaType
import okhttp3.OkHttpClient
import okhttp3.RequestBody
import wilderpereira.com.dreambox.model.Feature
import wilderpereira.com.dreambox.model.Image
import wilderpereira.com.dreambox.model.Request
import wilderpereira.com.dreambox.model.VisionDTO
import wilderpereira.com.dreambox.model.response.Response
import wilderpereira.com.dreambox.model.response.VisionResponseDTO
import java.util.ArrayList

class ChooseGoalActivity : AppCompatActivity() {

    val Tag: String = "Async"

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_choose_goal)
    }

    fun goalContinue(view: View) {
        //TODO: display dialog: "analisando seu extrato, verificamos que essa pode não ser a sua melhor opção - mostrar extrato etc"
    }

    fun photoClick(view: View) {
        vision().execute()
    }

    fun audioClick(view: View) {

    }

    inner class vision: AsyncTask<String, String, String>() {

        override fun doInBackground(vararg p0: String?): String {

            //calling Google Vision API
            try {
                val image = Image()
                image.content = "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"

                val labelDetectionFeature = Feature()
                labelDetectionFeature.type = "LABEL_DETECTION"

                val webDetectionFeature = Feature()
                webDetectionFeature.type = "WEB_DETECTION"

                val requests = Request()
                requests.features = mutableListOf(labelDetectionFeature, webDetectionFeature)
                requests.image = image

                val visionDto = VisionDTO()
                visionDto.requests = arrayListOf(requests)


//                val client =  OkHttpClient().newBuilder().hostnameVerifier { s, sslSession -> true}.build()
                val client =  OkHttpClient().newBuilder().build()

                val requestBody = RequestBody.create(MediaType.parse("application/json; charset=utf-8"), Gson().toJson(visionDto))

                val request = okhttp3.Request.Builder()
                        .url("https://vision.googleapis.com/v1/images:annotate?key=AIzaSyAVl9Z6AsGdrv-wnmZGXvDzJCGjbnRg42g")
                        .post(requestBody)
                        .build()

                return client.newCall(request).execute().body()!!.string()
            } catch(Ex: Exception) {
                Log.d("Async", "Error in doInBackground " + Ex.message);
            }
            return ""
        }

        override fun onPostExecute(result: String?) {
            super.onPostExecute(result)
            val response = Gson().fromJson(result, VisionResponseDTO::class.java)
            Log.d(Tag, response.toString())
        }
    }
}
